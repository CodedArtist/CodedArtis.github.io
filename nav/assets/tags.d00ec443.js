var t=Object.defineProperty,e=Object.prototype.hasOwnProperty,i=Object.getOwnPropertySymbols,a=Object.prototype.propertyIsEnumerable,l=(e,i,a)=>i in e?t(e,i,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[i]=a;import{_ as n,a as s}from"./Confirm.aaeb0a7c.js";import{s as o,t as u,h as b}from"./index.f79cac45.js";import{d as r,e as m,f as d,t as c,u as g,F as p,p as f,x as v,b as h,o as y,g as S,n as L,i as j}from"./vendor.4ef9e6b8.js";const x=S();f("data-v-1b743f28");const O={class:"block flex-between"},V=v("共 "),k={class:"is-size-3"},w=v(" 个标签");h();const C={expose:[],setup(t){const f=L(),v=r({columnList:[{label:"标签名",prop:"name"},{label:"色相值",prop:"hue"},{label:"关联书签数量",prop:"bookmarkNum"}],buttonList:[{text:"编辑",handler:I},{text:"删除",handler:function(t){S.tag=t,S.visible=!0}}],data:[]}),h=r({visible:!1,title:"",isSubmitting:!1,tag:{}}),S=r({visible:!1,title:"",isSubmitting:!1,tag:{}});function C(){o(!0),u.getAll().then((t=>{v.data=t;const e={};t.forEach((t=>e[t.id]=t)),f.commit("setTags",e)})).finally((()=>{o(!1)}))}function I(t){t?(h.title=`编辑标签“${t.name}”`,h.tag=((t,n)=>{for(var s in n||(n={}))e.call(n,s)&&l(t,s,n[s]);if(i)for(var s of i(n))a.call(n,s)&&l(t,s,n[s]);return t})({},t)):(h.title="新增标签",h.tag={name:"",hue:parseInt(360*Math.random())}),h.visible=!0}function U(){if(!h.tag.name||!h.tag.hue)return void alert("请填写完整表单");const t=h.tag.id?u.update(h.tag):u.add(h.tag);h.isSubmitting=!0,t.then((()=>{h.visible=!1,C()})).catch(b).finally((()=>{h.isSubmitting=!1}))}function _(){S.isSubmitting=!0,u.remove(S.tag.id).then((()=>{S.visible=!1,C()})).finally((()=>{S.isSubmitting=!1}))}return C(),(t,e)=>{const i=j("FormItem");return y(),m(p,null,[d("div",O,[d("span",null,[V,d("span",k,c(g(v).data.length),1),w]),d("button",{class:"level-item button is-primary",onClick:e[1]||(e[1]=t=>I())}," 创建新标签 ")]),d(n,{data:g(v).data,buttonList:g(v).buttonList,columnList:g(v).columnList},null,8,["data","buttonList","columnList"]),d(s,{visible:g(h).visible,"onUpdate:visible":e[4]||(e[4]=t=>g(h).visible=t),title:g(h).title,isSubmitting:g(h).isSubmitting,onConfirm:U},{default:x((()=>[d("div",null,[d(i,{label:"名称",modelValue:g(h).tag.name,"onUpdate:modelValue":e[2]||(e[2]=t=>g(h).tag.name=t)},null,8,["modelValue"]),d(i,{label:"Hue",type:"number",modelValue:g(h).tag.hue,"onUpdate:modelValue":e[3]||(e[3]=t=>g(h).tag.hue=t)},null,8,["modelValue"])])])),_:1},8,["visible","title","isSubmitting"]),d(s,{visible:g(S).visible,"onUpdate:visible":e[5]||(e[5]=t=>g(S).visible=t),confirmType:"danger",isSubmitting:g(S).isSubmitting,title:`确定要删除标签“${g(S).tag.name}”吗？`,onConfirm:_},null,8,["visible","isSubmitting","title"])],64)}},__scopeId:"data-v-1b743f28"};export default C;
